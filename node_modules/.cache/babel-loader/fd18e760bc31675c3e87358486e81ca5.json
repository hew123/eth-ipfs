{"ast":null,"code":"var _jsxFileName = \"/Users/hewhew/Downloads/create react app/eth-ipfs/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport web3 from './web3';\nimport ipfs from './ipfs';\nimport storehash from './storehash';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      ipfsHash: '',\n      contractAddress: '',\n      accAddress: '',\n      buffer: '',\n      returnHash: '',\n      transactionHash: '',\n      dataLink: ''\n    };\n\n    this.getHash = async event => {\n      event.preventDefault(); //get hash from contract\n\n      const contractAddress = await storehash.options.address;\n      this.setState({\n        contractAddress\n      });\n      const ipfsHash = await storehash.methods.getHash().call();\n      this.setState({\n        ipfsHash\n      });\n\n      try {\n        await window.ethereum.enable();\n        const accounts = await web3.eth.getAccounts();\n        const accAddress = accounts[0];\n        this.setState({\n          accAddress\n        });\n      } catch (error) {\n        console.log(error);\n      }\n\n      console.log(\"contract's info retrieved\");\n    };\n\n    this.captureFile = event => {\n      event.stopPropagation();\n      event.preventDefault();\n      let self = this;\n      const file = event.target.files[0];\n      let reader = new window.FileReader();\n      reader.readAsArrayBuffer(file);\n\n      reader.onload = async function (e) {\n        var rawLog = reader.result;\n        console.log(reader);\n        const buffer = await Buffer.from(rawLog);\n        self.setState({\n          buffer\n        });\n      };\n    };\n\n    this.onSubmit = async event => {\n      event.preventDefault(); //user's metamask account\n\n      try {\n        await window.ethereum.enable();\n        const accounts = await web3.eth.getAccounts();\n        const user = accounts[0];\n        console.log('Sending from Metamask account: ' + accounts[0]); //upload to ipfs\n\n        await ipfs.add(this.state.buffer, (err, result) => {\n          console.log(err, result);\n          this.setState({\n            returnHash: result[0].hash\n          }); //call contract methods\n\n          storehash.methods.saveHash(this.state.returnHash).send({\n            from: accounts[0]\n          }, (error, transactionHash) => {\n            console.log(transactionHash);\n            this.setState({\n              transactionHash\n            });\n          });\n        });\n      } catch (error) {\n        console.log(error);\n      }\n      /*const results = await ipfs.add(this.state.buffer);\n      console.log(\"ipfs upload result: \"+results);\n      const hash = results[0].hash;\n      console.log(hash);\n      this.setState({returnHash:hash});*/\n      //storehash.methods.saveHash(this.state.ipfsHash).send({from: user});\n\n    };\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \" Set new hash \"), React.createElement(\"form\", {\n      onSubmit: this.onSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"file\",\n      onChange: this.captureFile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"Upload to ipfs \")), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: this.getHash,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, \" Get Saved Hash \"), React.createElement(\"table\", {\n      bordered: true,\n      responsive: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"Tx Receipt Category\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, \"Values\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, \"IPFS Hash # stored on Eth Contract\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, this.state.ipfsHash)), React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, \"Ethereum Contract Address\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, this.state.contractAddress)), React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"From Account\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, this.state.accAddress)), React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, \" return hash \"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, this.state.returnHash)), React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \" data stored \"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, \" \", React.createElement(\"a\", {\n      href: this.state.ipfsHash,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, \" data \"))))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/hewhew/Downloads/create react app/eth-ipfs/src/App.js"],"names":["React","Component","web3","ipfs","storehash","App","state","ipfsHash","contractAddress","accAddress","buffer","returnHash","transactionHash","dataLink","getHash","event","preventDefault","options","address","setState","methods","call","window","ethereum","enable","accounts","eth","getAccounts","error","console","log","captureFile","stopPropagation","self","file","target","files","reader","FileReader","readAsArrayBuffer","onload","e","rawLog","result","Buffer","from","onSubmit","user","add","err","hash","saveHash","send","render"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport './App.css';\nimport web3 from './web3';\nimport ipfs from './ipfs';\nimport storehash from './storehash';\n\nclass App extends Component{\n\n  state = {\n    ipfsHash:'',\n    contractAddress:'',\n    accAddress:'',\n    buffer:'',\n    returnHash:'',\n    transactionHash:'',\n    dataLink:''\n  };\n\n    //get contract's info\n    getHash = async(event) =>{\n      event.preventDefault();\n\n      //get hash from contract\n      const contractAddress = await storehash.options.address;\n      this.setState({contractAddress});\n      const ipfsHash = await storehash.methods.getHash().call();\n      this.setState({ipfsHash});\n\n        try{\n          await window.ethereum.enable();\n          const accounts = await web3.eth.getAccounts();\n          const accAddress = accounts[0];\n          this.setState({accAddress});\n        } catch(error){\n          console.log(error);\n        }\n\n        console.log(\"contract's info retrieved\");\n\n      };//end of onClick\n\n      //uploading file\n      captureFile = (event) =>{\n        event.stopPropagation();\n        event.preventDefault();\n        let self = this;\n        const file = event.target.files[0];\n        let reader = new window.FileReader();\n        reader.readAsArrayBuffer(file);\n        reader.onload = async function(e) {\n          var rawLog = reader.result;\n          console.log(reader);\n          const buffer = await Buffer.from(rawLog);\n          self.setState({buffer});\n          };\n      };\n\n      //upload to ipfs\n      onSubmit = async (event) =>{\n        event.preventDefault();\n\n        //user's metamask account\n        try{\n          await window.ethereum.enable();\n          const accounts = await web3.eth.getAccounts();\n          const user = accounts[0];\n          console.log('Sending from Metamask account: ' + accounts[0]);\n\n\n          //upload to ipfs\n          await ipfs.add(this.state.buffer,(err,result) => {\n            console.log(err,result);\n            this.setState({returnHash:result[0].hash});\n\n            //call contract methods\n            storehash.methods.saveHash(this.state.returnHash).send(\n              {from:accounts[0]},(error,transactionHash) => {\n                console.log(transactionHash);\n                this.setState({transactionHash});\n              });\n            })\n\n          }catch(error){\n            console.log(error);\n          }\n\n          /*const results = await ipfs.add(this.state.buffer);\n          console.log(\"ipfs upload result: \"+results);\n          const hash = results[0].hash;\n          console.log(hash);\n          this.setState({returnHash:hash});*/\n          //storehash.methods.saveHash(this.state.ipfsHash).send({from: user});\n        };\n\n    render(){\n      return(\n        <div className=\"App\">\n            <h3> Set new hash </h3>\n            <form onSubmit={this.onSubmit}>\n            <input type=\"file\" onChange={this.captureFile}/>\n                <button type=\"submit\">\n                    Upload to ipfs </button>\n                    </form>\n                    <hr/>\n\n\n        <button onClick = {this.getHash}> Get Saved Hash </button>\n\n          <table bordered responsive>\n                <thead>\n                  <tr>\n                    <th>Tx Receipt Category</th>\n                    <th>Values</th>\n                  </tr>\n                </thead>\n\n                <tbody>\n                  <tr>\n                    <td>IPFS Hash # stored on Eth Contract</td>\n                    <td>{this.state.ipfsHash}</td>\n                  </tr>\n                  <tr>\n                    <td>Ethereum Contract Address</td>\n                    <td>{this.state.contractAddress}</td>\n                  </tr>\n                  <tr>\n                    <td>From Account</td>\n                    <td>{this.state.accAddress}</td>\n                  </tr>\n                  <tr>\n                    <td> return hash </td>\n                    <td>{this.state.returnHash}</td>\n                  </tr>\n                  <tr>\n                    <td> data stored </td>\n                    <td> <a href={this.state.ipfsHash}> data </a></td>\n                  </tr>\n                </tbody>\n            </table>\n     </div>\n      );\n    }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}